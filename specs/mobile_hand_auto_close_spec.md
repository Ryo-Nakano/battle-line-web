# モバイル手札選択画面の自動クローズ機能

## 概要

モバイルUIにおいて、手札選択画面（ExpandedModal）でカードを選択した際に、画面を自動的に閉じる機能を追加する。また、閉じる際に下方向への滑らかなスライドアニメーションを実装する。

## 現状の動作

- PreviewBarをタップすると手札選択画面（ExpandedModal）が開く
- カードをタップすると `activeCard` がセットされるが、モーダルは閉じない
- モーダルを閉じるには、×ボタンまたは背景のタップが必要

## 要件

### 1. 自動クローズの動作

| 操作 | 動作 |
|------|------|
| 未選択状態でカードをタップ | カードを選択し、モーダルを**閉じる** |
| 選択中のカードをタップ | カードの選択を解除し、モーダルは**閉じない** |

### 2. 閉じるアニメーション

- モーダルが閉じる際、下方向に滑らかにスライドして消える
- 開くアニメーション(`slide-in-from-bottom`, 200ms)よりゆっくりと閉じる
- アニメーション時間: 約 300〜400ms（ぬるっとした感触）
- イージング: ease-out 系で自然な減速

## 対象ファイル

### [MODIFY] MobileHand.tsx

`src/board/MobileHand.tsx`

#### 変更内容

1. **closing状態の追加**
   - `isClosing` stateを追加し、閉じるアニメーション中かどうかを管理

2. **閉じるハンドラの修正**
   - `onClose` を直接呼ぶ代わりに、`isClosing` をtrueにしてアニメーション開始
   - アニメーション完了後に `onClose` を呼び出す

3. **ExpandedModalへのコールバック追加**
   - カード選択時にモーダルを閉じるか判定するロジックを追加
   - 新規選択時のみモーダルを閉じる

4. **CSSアニメーションの追加**
   - 閉じる際の `slide-out-to-bottom` アニメーションを適用
   - duration: 300〜400ms

## 技術的な実装方針

### アニメーション実装方法

Tailwind CSSの `animate-` クラスとカスタムアニメーションを使用:

```tsx
// 開くとき
className="animate-in slide-in-from-bottom duration-200"

// 閉じるとき（isClosing時）
className="animate-out slide-out-to-bottom duration-300"
```

### 状態管理フロー

```
1. カードタップ
2. 既に選択中のカードか判定
   - YES → 選択解除のみ（モーダルは閉じない）
   - NO → 選択 + isClosing = true
3. isClosing = true でアニメーション開始
4. onAnimationEnd で onClose() 呼び出し
```

## 検証方法

1. モバイルビューで手札プレビューをタップ
2. 未選択のカードをタップ → モーダルがスライドダウンして閉じることを確認
3. 再度開いて、選択中のカードをタップ → 選択解除されモーダルは開いたまま
4. 別のカードをタップ → モーダルがスライドダウンして閉じることを確認
5. ×ボタンや背景タップでも同様のアニメーションで閉じること
