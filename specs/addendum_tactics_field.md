# 謀略戦術使用エリアの実装仕様書

## 概要
使い切りタイプの謀略戦術カード（スカウト、配置転換、脱走、裏切り）を使用するための専用エリア「謀略戦術エリア (`tacticsField`)」を新設する。
これにより、プレイヤーは「効果を使いたいカードを一旦場に出す」という直感的な操作が可能になる。
また、スカウトカード使用時の「3枚ドロー」処理を自動化し、プレイ体験を向上させる。

## 1. データ構造の変更

### `src/Game.js`
`G` オブジェクトに以下を追加する。

```javascript
G = {
  // ...既存プロパティ
  tacticsField: {
    '0': [], // Player 0 の使用中カードリスト
    '1': []  // Player 1 の使用中カードリスト
  }
}
```

## 2. 処理ロジックの変更 (`src/moves.js`)

### 新規エリアへの移動 (`moveCard`)
*   **移動許可**: 手札 (`hand`) から謀略戦術エリア (`tacticsField`) への移動を許可する。
*   **バリデーション**:
    *   移動できるのは「謀略戦術（Guile）」カテゴリのカード (`Scout`, `Redeploy`, `Deserter`, `Traitor`) のみ。
    *   他のカテゴリ（環境戦術、部隊系戦術）は移動不可。

### スカウト効果のサポート
*   **仕様変更**: ユーザーからの指摘により、一括自動ドローではなく「合計3枚まで自由にドローできる状態」にする。
*   **実装方針**:
    *   `G` オブジェクトに `scoutDrawCount` (スカウト使用中のドロー済み枚数) を追加する。初期値は `null`。
    *   スカウトカードが `tacticsField` に移動された時点で、`G.scoutDrawCount` を `0` に設定する。
    *   `drawCard` ムーブを修正:
        *   通常は「ターンにつき1枚まで（ドローしたらターン終了待ち）」だが、`G.scoutDrawCount` が有効な場合（0以上3未満）は、ドロー後もターンを終了させず、カウントをインクリメントする。
        *   カウントが `3` になったら、ドロー制限を戻す（または次のフェーズ「2枚戻す」へ移行するが、今回は「3枚引く」までのサポートに留める）。

### ターン終了時の処理 (`endTurn`)
*   ターン終了時、`G.tacticsField` にある全てのカードを `G.tacticDiscard`（戦術カード捨て札）に移動する。
*   移動後、`G.tacticsField` は空にする。

## 3. UIの変更 (`src/board/Board.tsx`)

### 謀略戦術エリアの表示
*   **自分側 (`Footer`)**: 手札エリア (`Hand`) の上部に、カード1枚分の高さを持つ `DropZone` を配置。
    *   ラベル: "TACTICS FIELD"
    *   ここにカードがあるときは、そのカードを表向きで表示。
*   **相手側 (`Header`)**: 相手情報エリアの下部に同様のエリアを表示。
    *   相手が出したカードも表向きで表示（公開情報）。

### スカウト使用時のUI
*   スカウトカードが `tacticsField` に置かれた場合、以下の状態処理を追加する。
    *   状態管理 `scoutDraftCount` (ドローした枚数) を導入（または `G` で管理）。
    *   今回は「3枚ドローの自動化」の指示だが、内訳選択が必須なため、**「部隊/戦術デッキのどちらかをクリックして3枚引く」操作を強制する**形で実装する。
    *   もしくは、スカウト配置時に `window.confirm` 等で簡易的に聞くか、専用モーダルを出す。
    *   *推奨*: スカウト配置直後、`G.isScouting = true` となり、デッキをクリックすると通常ドローではなく「スカウトドロー（3枚引くまで継続）」モードになる。

## 実装ステップ

1.  **データ構造とMove更新**: `Game.js` と `moves.js` を修正し、`tacticsField` とそこへの移動、ターン終了時の片付けを実装。
2.  **UI配置**: `Board.tsx` に `tacticsField` 用の `Zone` を追加（自分用・相手用）。
3.  **スカウトロジック**: スカウト配置時の挙動（ドロー処理への誘導）を実装。
    *   今回はシンプルに「スカウトを置く -> デッキをクリックしてドロー」の流れをスムーズにすることを目指す。自動で3枚引くのは「内訳が決まっていない」ため不可能であることを考慮し、**「スカウトを置いたら、デッキをクリックして3枚引ける状態にする（通常は1枚制限）」** という形で「機能としての自動化（制限解除）」を行う。

